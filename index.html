<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rebecca Bachata Events</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&family=Playfair+Display:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #d35400;
            --primary-light: #e67e22;
            --primary-lighter: #f39c12;
            --primary-gradient: linear-gradient(135deg, var(--primary), var(--primary-light), var(--primary-lighter));
            --dark-bg: #1a1a2e;
            --darker-bg: #16213e;
            --text-dark: #222;
            --text-medium: #444;
            --text-light: #777;
            --light-bg: #f9fbfd;
            --lighter-bg: #f1f5fa;
            --white: #ffffff;
            --success: #27ae60;
            --info: #3498db;
            --elegant-shadow: 0 12px 30px rgba(0, 0, 0, 0.08);
            --subtle-border: 1px solid rgba(0, 0, 0, 0.04);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-rendering: optimizeLegibility;
            -webkit-font-smoothing: subpixel-antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        body {
            min-height: 100vh;
            padding: 25px 18px;
            color: var(--text-dark);
            background: linear-gradient(135deg, var(--light-bg), var(--lighter-bg));
            line-height: 1.68;
            font-size: 1.08rem;
            letter-spacing: 0.35px;
        }
        
        .container {
            width: 100%;
            max-width: 920px;
            margin: 0 auto;
            background: var(--white);
            border-radius: 20px;
            overflow: hidden;
            padding: 45px 35px;
            box-shadow: var(--elegant-shadow);
            border: var(--subtle-border);
        }
        
        .section-title {
            font-size: 1.9rem;
            font-weight: 750;
            margin: 48px 0 30px;
            text-align: center;
            position: relative;
            display: block;
            width: 100%;
            color: var(--text-dark);
            padding-bottom: 14px;
            font-family: 'Playfair Display', serif;
            letter-spacing: 0.3px;
        }
        
        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 90px;
            height: 3.5px;
            background: linear-gradient(to right, var(--primary), var(--primary-light));
            border-radius: 2px;
        }
        
        /* EVENTS CAROUSEL STYLES */
        .events-carousel-container {
            margin: 40px 0;
            position: relative;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
        }
        
        .events-carousel-container.hidden {
            display: none;
        }
        
        .carousel {
            position: relative;
            overflow: hidden;
            border-radius: 18px;
            background: white;
            padding: 15px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 100%;
        }
        
        .carousel-track-container {
            overflow: hidden;
            width: 100%;
            max-width: 100%;
        }
        
        .carousel-track {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 100%;
        }
        
        .carousel-slide {
            min-width: 100%;
            flex: 0 0 auto;
            padding: 0 15px;
            box-sizing: border-box;
            width: 100%;
            max-width: 100%;
        }
        
        /* Modern compact event card */
        .event-card {
            background: var(--white);
            border-radius: 14px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
            border: 1px solid rgba(0, 0, 0, 0.04);
            text-align: center;
            height: auto;
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }
        
        .event-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 5px;
            height: 100%;
            background: var(--primary-gradient);
        }
        
        .event-date {
            font-weight: 700;
            color: var(--primary);
            font-size: 1rem;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px dashed rgba(230, 126, 34, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .event-date i {
            font-size: 0.9rem;
        }
        
        .event-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
            line-height: 1.3;
        }
        
        .event-location {
            color: var(--text-medium);
            margin-bottom: 12px;
            font-weight: 500;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .event-location i {
            font-size: 0.85rem;
        }
        
        .event-description {
            color: var(--text-light);
            line-height: 1.5;
            margin-bottom: 15px;
            font-size: 0.95rem;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
        
        .event-button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: inline-block;
            text-decoration: none;
            margin-top: 10px;
            font-size: 0.95rem;
            align-self: center;
        }
        
        .event-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 126, 34, 0.3);
        }
        
        .carousel-button {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: var(--primary);
            color: white;
            border: none;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            font-size: 0.9rem;
            cursor: pointer;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.15);
            transition: var(--transition);
        }
        
        .carousel-button:hover {
            background: var(--primary-light);
            transform: translateY(-50%) scale(1.1);
        }
        
        .carousel-button.prev {
            left: 5px;
        }
        
        .carousel-button.next {
            right: 5px;
        }
        
        .carousel-nav {
            display: flex;
            justify-content: center;
            margin-top: 20px;
            gap: 8px;
        }
        
        .carousel-indicator {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(230, 126, 34, 0.3);
            border: none;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .carousel-indicator.current-slide {
            background: var(--primary);
            transform: scale(1.2);
        }
        
        .events-loading {
            text-align: center;
            padding: 40px 0;
            color: var(--text-medium);
        }
        
        .events-error {
            text-align: center;
            padding: 40px 0;
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            border-radius: 10px;
            margin: 20px 0;
        }
        
        .events-empty {
            text-align: center;
            padding: 40px 0;
            color: var(--text-medium);
            font-style: italic;
        }
        
        .refresh-button {
            background: var(--primary-gradient);
            color: white;
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            margin-top: 15px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .refresh-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(230, 126, 34, 0.3);
        }
        
        /* END OF EVENTS CAROUSEL STYLES */
        
        /* CLASS CTA STYLES */
        .class-cta-container {
            background: linear-gradient(135deg, #f9f7f3, #fdfcf9);
            border-radius: 18px;
            padding: 28px 35px;
            margin: 25px 0 30px;
            display: flex;
            flex-direction: column;
            color: #2c3e50;
            text-align: center;
            box-shadow: 0 9px 28px rgba(0, 0, 0, 0.06);
            border: 0.8px solid #e8e4dc;
            position: relative;
            overflow: hidden;
        }
        
        .cta-header {
            font-size: 1.35rem;
            font-weight: 680;
            margin-bottom: 18px;
            letter-spacing: 0.35px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            color: var(--primary);
            z-index: 2;
        }
        
        .cta-header i {
            font-size: 1.45rem;
            color: var(--primary);
        }
        
        .cta-schedule {
            background: rgba(230, 126, 34, 0.07);
            border-radius: 12px;
            padding: 14px 18px;
            margin-bottom: 18px;
            font-size: 1.0rem;
            line-height: 1.6;
            color: #2c3e50;
            z-index: 2;
        }
        
        .cta-action {
            font-size: 1.15rem;
            font-weight: 620;
            padding: 16px;
            background: var(--primary-gradient);
            color: white;
            border-radius: 50px;
            transition: all 0.35s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 6px 18px rgba(230, 126, 34, 0.18);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            min-height: 60px;
            z-index: 2;
        }
        
        .cta-action:hover {
            background: linear-gradient(135deg, #c14f00, #d3731f);
            transform: scale(1.025);
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.025); }
            100% { transform: scale(1); }
        }
        
        .pulse {
            animation: pulse 1.8s infinite;
        }
        
        .down-arrow {
            animation: gentle-bounce 2.2s infinite;
            display: inline-block;
            font-size: 0.95em;
        }
        
        @keyframes gentle-bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }
        
        /* RESPONSIVE STYLES */
        @media (max-width: 800px) {
            .container {
                padding: 30px 25px;
            }
            
            .section-title {
                font-size: 1.7rem;
                margin: 40px 0 25px;
            }
            
            .cta-header {
                font-size: 1.2rem;
            }
            
            .cta-schedule {
                font-size: 0.95rem;
                padding: 12px;
            }
            
            .cta-action {
                font-size: 1.05rem;
                padding: 14px;
            }
            
            /* Mobile events carousel adjustments */
            .carousel-button {
                width: 32px;
                height: 32px;
                font-size: 0.8rem;
            }
            
            .event-card {
                padding: 15px;
            }
            
            .event-title {
                font-size: 1.15rem;
            }
            
            .event-date {
                font-size: 0.95rem;
            }
            
            .event-location {
                font-size: 0.9rem;
            }
            
            .event-description {
                font-size: 0.85rem;
                -webkit-line-clamp: 4;
            }
            
            .event-button {
                padding: 8px 16px;
                font-size: 0.9rem;
            }
            
            .carousel-slide {
                padding: 0 10px;
            }
        }
        
        @media (max-width: 480px) {
            body {
                font-size: 1.05rem;
                padding: 18px 12px;
            }
            
            .container {
                padding: 30px 18px;
                border-radius: 18px;
            }
            
            .section-title {
                font-size: 1.5rem;
                margin: 35px 0 25px;
            }
            
            .cta-header {
                flex-direction: column;
                gap: 8px;
            }
            
            .cta-header i {
                font-size: 1.25rem;
            }
            
            .cta-schedule {
                font-size: 0.9rem;
                padding: 10px 12px;
            }
            
            .cta-action {
                font-size: 0.95rem;
                padding: 12px;
            }
            
            /* Extra small device event card improvements */
            .carousel-button {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
            
            .event-card {
                padding: 12px;
            }
            
            .event-title {
                font-size: 1.05rem;
            }
            
            .event-date {
                font-size: 0.9rem;
            }
            
            .event-location {
                font-size: 0.85rem;
            }
            
            .event-description {
                font-size: 0.8rem;
                -webkit-line-clamp: 4;
            }
            
            .event-button {
                padding: 7px 14px;
                font-size: 0.85rem;
            }
            
            .carousel-slide {
                padding: 0 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Events Carousel Section -->
        <div class="events-carousel-container" id="events-carousel">
            <h2 class="section-title">Upcoming Events</h2>
            <div class="carousel">
                <button class="carousel-button prev">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <div class="carousel-track-container">
                    <ul class="carousel-track" id="events-track">
                        <li class="carousel-slide">
                            <div class="events-loading">
                                <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 15px;"></i>
                                <p>Loading events from calendar...</p>
                            </div>
                        </li>
                    </ul>
                </div>
                <button class="carousel-button next">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
            <div class="carousel-nav" id="events-nav"></div>
        </div>
        
        <!-- Class CTA Section -->
        <h2 class="section-title" id="upcoming-title">Join Our Classes</h2>
        
        <div id="class-cta" class="class-cta-container">
            <div class="cta-header">
                <i class="fas fa-calendar-day pulse"></i>
                <div id="cta-title">Tonight at Serrata Studio</div>
                <i class="fas fa-star pulse"></i>
            </div>
            
            <div class="cta-schedule" id="cta-schedule">
                7:15pm Salsa | 8:15pm Bachata
            </div>
            
            <div class="cta-action" id="register-cta">
                <span id="register-cta-text">Register Now</span> <span class="down-arrow"><i class="fas fa-arrow-down"></i></span>
            </div>
        </div>
    </div>

    <script>
        // Class schedule data
        const classSchedule = [
            { 
                day: "Monday", 
                dayIndex: 1,
                studio: "Stardust Ballroom",
                classes: [
                    "6:30pm Bachata Intro",
                    "7:00pm Bachata Fundamentals",
                    "8:00pm Bachata Next Level"
                ],
                startTime: 1830,
                endTime: 2100
            },
            { 
                day: "Wednesday", 
                dayIndex: 3,
                studio: "Serrata Studio",
                classes: [
                    "7:15pm Salsa",
                    "8:15pm Bachata"
                ],
                startTime: 1915,
                endTime: 2215
            },
            { 
                day: "Thursday", 
                dayIndex: 4,
                studio: "Stardust Ballroom",
                classes: [
                    "6:30pm Intro to Salsa",
                    "7:00pm Salsa Open Level",
                    "8:00pm Bachata Open Level"
                ],
                startTime: 1830,
                endTime: 2100
            },
            { 
                day: "Friday", 
                dayIndex: 5,
                studio: "Let's Bailar Dance Studio",
                classes: [
                    "7:00pm Salsa",
                    "8:00pm Bachata"
                ],
                startTime: 1900,
                endTime: 2100
            },
            { 
                day: "Saturday", 
                dayIndex: 6,
                studio: "Serrata Studio",
                classes: [
                    "10:30am Bachata",
                    "11:30am Salsa"
                ],
                startTime: 1030,
                endTime: 1300
            },
            { 
                day: "Saturday", 
                dayIndex: 6,
                studio: "Estilo Dance Studio",
                classes: [
                    "4:00pm Salsa",
                    "5:00pm Bachata"
                ],
                startTime: 1600,
                endTime: 1800
            }
        ];

        // Function to get next class information
        function getNextClassInfo() {
            const now = new Date();
            const currentDayIndex = now.getDay(); 
            const currentHours = now.getHours();
            const currentMinutes = now.getMinutes();
            const currentTime = currentHours * 100 + currentMinutes;
            
            const sortedClasses = [...classSchedule].sort((a, b) => {
                if (a.dayIndex === b.dayIndex) {
                    return a.startTime - b.startTime;
                }
                return a.dayIndex - b.dayIndex;
            });
            
            const todayClass = sortedClasses.find(s => 
                s.dayIndex === currentDayIndex && 
                currentTime < s.endTime
            );
            
            if (todayClass) {
                return {
                    day: todayClass.day,
                    studio: todayClass.studio,
                    schedule: todayClass.classes,
                    timePrefix: "Tonight",
                    locationId: todayClass.locationId
                };
            }
            
            const futureClasses = sortedClasses.filter(s => s.dayIndex > currentDayIndex);
            
            if (futureClasses.length > 0) {
                const nextClass = futureClasses[0];
                const dayDifference = nextClass.dayIndex - currentDayIndex;
                let timePrefix = "";
                
                if (dayDifference === 1) {
                    timePrefix = "Tomorrow";
                } else if (dayDifference === 2) {
                    timePrefix = "This " + nextClass.day;
                } else {
                    timePrefix = "Next " + nextClass.day;
                }
                
                return {
                    day: nextClass.day,
                    studio: nextClass.studio,
                    schedule: nextClass.classes,
                    timePrefix: timePrefix,
                    locationId: nextClass.locationId
                };
            }
            
            const nextClass = sortedClasses[0];
            return {
                day: nextClass.day,
                studio: nextClass.studio,
                schedule: nextClass.classes,
                timePrefix: "Next " + nextClass.day,
                locationId: nextClass.locationId
            };
        }

        // Function to update CTA section
        function updateCTASection() {
            const nextClass = getNextClassInfo();
            
            const ctaTitle = document.getElementById('cta-title');
            ctaTitle.innerHTML = `<span class="pulse">${nextClass.timePrefix}</span>: ${nextClass.studio}`;
            
            document.getElementById('cta-schedule').textContent = nextClass.schedule.join(' | ');
        }
        
        // EVENTS CAROUSEL FUNCTIONS
        async function fetchCalendarEvents() {
            const icalUrl = 'https://calendar.google.com/calendar/ical/42ea635b03e7b52add3eac2994bb884a3ef3c2f1403a0003ded9fbb4d5ebcce1%40group.calendar.google.com/private-eae60ffc005caa94a28d3d5405872d97/basic.ics';
            
            try {
                const eventsTrack = document.getElementById('events-track');
                eventsTrack.innerHTML = `
                    <li class="carousel-slide">
                        <div class="events-loading">
                            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Loading events from calendar...</p>
                        </div>
                    </li>
                `;
                
                const proxyUrl = 'https://corsproxy.io/?';
                const response = await fetch(proxyUrl + encodeURIComponent(icalUrl));
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const icalData = await response.text();
                
                const events = parseICalData(icalData);
                
                updateEventsCarousel(events);
            } catch (error) {
                console.error('Error fetching calendar events:', error);
                
                const eventsTrack = document.getElementById('events-track');
                eventsTrack.innerHTML = `
                    <li class="carousel-slide">
                        <div class="events-error">
                            <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 15px;"></i>
                            <p>Failed to load events from calendar.</p>
                            <button class="refresh-button" onclick="fetchCalendarEvents()">
                                <i class="fas fa-sync-alt"></i> Try Again
                            </button>
                        </div>
                    </li>
                `;
            }
        }
        
        function parseICalData(icalData) {
            const events = [];
            const lines = icalData.split('\n');
            let currentEvent = null;
            let inEvent = false;
            let inDescription = false;
            let descriptionLines = [];
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i].trim();
                
                if (line === 'BEGIN:VEVENT') {
                    inEvent = true;
                    currentEvent = {};
                } else if (line === 'END:VEVENT') {
                    inEvent = false;
                    inDescription = false;
                    
                    if (descriptionLines.length > 0) {
                        currentEvent.description = descriptionLines.join('\n')
                            .replace(/\\,/g, ',')
                            .replace(/\\;/g, ';')
                            .replace(/\\n/g, '\n')
                            .trim();
                        descriptionLines = [];
                    }
                    
                    if (currentEvent && currentEvent.summary && currentEvent.start) {
                        const eventDate = new Date(currentEvent.start);
                        const now = new Date();
                        
                        if (eventDate >= now) {
                            events.push(currentEvent);
                        }
                    }
                    currentEvent = null;
                } else if (inEvent && currentEvent !== null) {
                    if (line.startsWith('SUMMARY:')) {
                        currentEvent.summary = line.substring(8).replace(/\\,/g, ',').replace(/\\;/g, ';');
                    } else if (line.startsWith('DTSTART:')) {
                        const dateStr = line.substring(8);
                        currentEvent.start = parseICalDate(dateStr);
                    } else if (line.startsWith('DTEND:')) {
                        const dateStr = line.substring(6);
                        currentEvent.end = parseICalDate(dateStr);
                    } else if (line.startsWith('LOCATION:')) {
                        currentEvent.location = line.substring(9).replace(/\\,/g, ',').replace(/\\;/g, ';');
                    } else if (line.startsWith('DESCRIPTION:')) {
                        inDescription = true;
                        descriptionLines.push(line.substring(12));
                    } else if (inDescription && line.startsWith(' ')) {
                        descriptionLines.push(line.substring(1));
                    } else if (line.indexOf(':') !== -1) {
                        inDescription = false;
                    }
                }
            }
            
            events.sort((a, b) => new Date(a.start) - new Date(b.start));
            
            // Limit to 5 most recent upcoming events
            return events.slice(0, 5);
        }
        
        function parseICalDate(dateStr) {
            if (dateStr.includes('T')) {
                const year = dateStr.substring(0, 4);
                const month = dateStr.substring(4, 6) - 1;
                const day = dateStr.substring(6, 8);
                const hour = dateStr.substring(9, 11) || 0;
                const minute = dateStr.substring(11, 13) || 0;
                const second = dateStr.substring(13, 15) || 0;
                
                if (dateStr.endsWith('Z')) {
                    return new Date(Date.UTC(year, month, day, hour, minute, second));
                }
                
                return new Date(year, month, day, hour, minute, second);
            } else {
                const year = dateStr.substring(0, 4);
                const month = dateStr.substring(4, 6) - 1;
                const day = dateStr.substring(6, 8);
                
                return new Date(year, month, day);
            }
        }
        
        function updateEventsCarousel(events) {
            const eventsTrack = document.getElementById('events-track');
            const eventsNav = document.getElementById('events-nav');
            const eventsContainer = document.getElementById('events-carousel');
            
            eventsTrack.innerHTML = '';
            eventsNav.innerHTML = '';
            
            if (events.length === 0) {
                eventsContainer.classList.add('hidden');
                return;
            }
            
            // Show the container if there are events
            eventsContainer.classList.remove('hidden');
            
            events.forEach((event, index) => {
                const slide = document.createElement('li');
                slide.className = 'carousel-slide';
                
                const eventDate = new Date(event.start);
                const options = { 
                    weekday: 'short', 
                    year: 'numeric', 
                    month: 'short', 
                    day: 'numeric',
                    hour: 'numeric',
                    minute: '2-digit'
                };
                const formattedDate = eventDate.toLocaleDateString('en-US', options);
                
                let description = event.description || '';
                if (description.length > 200) {
                    description = description.substring(0, 200) + '...';
                }
                
                slide.innerHTML = `
                    <div class="event-card">
                        <div class="event-date"><i class="far fa-calendar-alt"></i> ${formattedDate}</div>
                        <h3 class="event-title">${event.summary || 'Dance Event'}</h3>
                        ${event.location ? `<div class="event-location"><i class="fas fa-map-marker-alt"></i> ${event.location}</div>` : ''}
                        ${description ? `<p class="event-description">${description}</p>` : ''}
                        <a href="#registration-form" class="event-button">Register Now</a>
                    </div>
                `;
                
                eventsTrack.appendChild(slide);
                
                const indicator = document.createElement('button');
                indicator.className = 'carousel-indicator';
                indicator.dataset.index = index;
                eventsNav.appendChild(indicator);
            });
            
            initCarouselFunctionality();
        }
        
        function initCarouselFunctionality() {
            const track = document.getElementById('events-track');
            const nav = document.getElementById('events-nav');
            const slides = Array.from(track.children);
            const indicators = Array.from(nav.children);
            const nextButton = document.querySelector('.carousel-button.next');
            const prevButton = document.querySelector('.carousel-button.prev');
            
            if (slides.length <= 1) {
                nextButton.style.display = 'none';
                prevButton.style.display = 'none';
                nav.style.display = 'none';
                return;
            }
            
            let currentIndex = 0;
            
            function setActiveSlide(index) {
                indicators.forEach(indicator => {
                    indicator.classList.remove('current-slide');
                });
                if (indicators[index]) {
                    indicators[index].classList.add('current-slide');
                }
                
                track.style.transform = `translateX(-${index * 100}%)`;
                
                prevButton.style.display = index === 0 ? 'none' : 'flex';
                nextButton.style.display = index === slides.length - 1 ? 'none' : 'flex';
            }
            
            nextButton.addEventListener('click', () => {
                if (currentIndex < slides.length - 1) {
                    currentIndex++;
                    setActiveSlide(currentIndex);
                }
            });
            
            prevButton.addEventListener('click', () => {
                if (currentIndex > 0) {
                    currentIndex--;
                    setActiveSlide(currentIndex);
                }
            });
            
            indicators.forEach((indicator, index) => {
                indicator.addEventListener('click', () => {
                    currentIndex = index;
                    setActiveSlide(currentIndex);
                });
            });
            
            let autoAdvance = setInterval(() => {
                if (currentIndex < slides.length - 1) {
                    currentIndex++;
                    setActiveSlide(currentIndex);
                } else {
                    currentIndex = 0;
                    setActiveSlide(currentIndex);
                }
            }, 5000);
            
            const carousel = document.querySelector('.carousel');
            carousel.addEventListener('mouseenter', () => {
                clearInterval(autoAdvance);
            });
            
            carousel.addEventListener('mouseleave', () => {
                autoAdvance = setInterval(() => {
                    if (currentIndex < slides.length - 1) {
                        currentIndex++;
                        setActiveSlide(currentIndex);
                    } else {
                        currentIndex = 0;
                        setActiveSlide(currentIndex);
                    }
                }, 5000);
            });
            
            setActiveSlide(0);
        }
        
        function initEventsCarousel() {
            fetchCalendarEvents();
            
            // Refresh events every hour
            setInterval(fetchCalendarEvents, 60 * 60 * 1000);
        }
        
        // Initialize the page
        function initPage() {
            updateCTASection();
            initEventsCarousel();
            
            setInterval(() => {
                updateCTASection();
            }, 60000);
        }

        // Start everything when the DOM is loaded
        document.addEventListener('DOMContentLoaded', initPage);
    </script>
</body>
</html>
